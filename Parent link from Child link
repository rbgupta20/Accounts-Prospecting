# Step 1: Install necessary packages
!pip install pandas --quiet
from urllib.parse import urlparse
import pandas as pd
from google.colab import files

# Step 2: Upload your CSV
uploaded = files.upload()  # Will prompt to upload CSV

# Step 3: Read the CSV (replace 'your_file.csv' with uploaded filename)
for filename in uploaded.keys():
    df = pd.read_csv(filename)

# Step 4: Extract parent link
def get_parent_link(child_link):
    try:
        parsed = urlparse(child_link)
        return f"{parsed.scheme}://{parsed.netloc}"
    except:
        return ""

# Assuming your column of links is named 'link'
df['parent_link'] = df['link'].apply(get_parent_link)

# Step 5: Save new CSV
output_file = "parent_links_output.csv"
df.to_csv(output_file, index=False)

# Step 6: Download CSV automatically
files.download(output_file)
